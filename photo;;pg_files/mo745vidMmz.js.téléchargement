;/*FB_PKG_DELIM*/

__d("MWAudioPlayerWithRetry.react",["I64","MAWGetIsMediaDownloadStatusEnabled","MWMediaRenderQplUtils","MWPAudioHighlightStylesHooks","MWPAudioPlaybackButton.react","MWPAudioPlayerButtons.react","MWPAudioPlayerContainer.react","MWPAudioPlayerHighlight.react","MWPAudioPlayerKeyCommands.react","MWPAudioPlayerSharedStyles","MWPAudioPlayerTimer.react","MWPAudioPlayerUtils","MWXMessageBubbleCornerStyles.react","react","react-compiler-runtime","requireDeferred","stylex","useMAWMediaStatusUIState","useMWNextAttachment","useMWPAudioWaveformData.react","useMWPMarkAudioAttachmentAsConsumed.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=i||(i=d("react"));b=i;var l=b.useEffect,m=b.useRef,n=c("requireDeferred")("MWChatAudioLog").__setRef("MWAudioPlayerWithRetry.react");function o(){n.onReady(function(a){return a.logBrowserDenyAccess()})}function a(a){var b=d("react-compiler-runtime").c(68),e=a.attachment,f=a.connectBottom,g=a.connectTop,i=a.getPlayableUrl,n=a.isReply,p=a.isSecure,q=a.mediaRenderQpl,r=a.message,s=a.outgoing,t=a.renderUnsupportedAttachment;a=a.width;n=n===void 0?!1:n;var u=e.playableDurationMs,v=(j||(j=d("I64"))).to_float((u=u)!=null?u:(j||(j=d("I64"))).zero)/1e3,w=c("useMWNextAttachment")(e,r);b[0]!==p||b[1]!==w?(u=p&&d("MAWGetIsMediaDownloadStatusEnabled").getIsMediaDownloadStatusEnabled()?w:null,b[0]=p,b[1]=w,b[2]=u):u=b[2];p=u;u=c("useMAWMediaStatusUIState")(p,q);p=u.downloadStatus;b[3]!==e||b[4]!==i||b[5]!==q?(u=i(e,"MWAudioPlayer",q),b[3]=e,b[4]=i,b[5]=q,b[6]=u):u=b[6];var x=u,y=c("useMWPAudioWaveformData.react")(e,x);u=d("MWXMessageBubbleCornerStyles.react").getMWXBubbleCornerStyles({align:s===!0?"right":"left",connectBottom:f,connectTop:g});b[7]!==i||b[8]!==w||b[9]!==p?(f=w!=null&&(p==null||p==="downloaded")?i(w,"MWAudioPlayer"):void 0,b[7]=i,b[8]=w,b[9]=p,b[10]=f):f=b[10];g=d("MWPAudioPlayerUtils").useControlCenterWithRetry(x,f,r.messageId,w==null?void 0:w.messageId,o,!1,v,q);i=g[0];p=g[1];f=g[2];var z=g[3],A=g[4];g=g[5];c("useMWPMarkAudioAttachmentAsConsumed.react")(f,e);if(b[11]!==r.ephemeralDurationInSec){var B;B=(j||(j=d("I64"))).gt((B=r.ephemeralDurationInSec)!=null?B:(j||(j=d("I64"))).zero,j.zero);b[11]=r.ephemeralDurationInSec;b[12]=B}else B=b[12];var C=B;r=i===d("MWPAudioPlayerUtils").State.NONE;B=i===d("MWPAudioPlayerUtils").State.PLAYING;var D=i===d("MWPAudioPlayerUtils").State.PAUSED,E=i===d("MWPAudioPlayerUtils").State.LOADING;i=i===d("MWPAudioPlayerUtils").State.ENDED;var F=B||D,G=m(),H=d("MWPAudioHighlightStylesHooks").useHighlightStyles(s);a=d("MWPAudioPlayerUtils").useCalculatePlayerWidth(a,C);a=a+"px";var I;b[13]!==a?(I={width:a},b[13]=a,b[14]=I):I=b[14];a=I;I=F?Math.max(v-p,0):0;var J,K;b[15]!==v||b[16]!==C||b[17]!==q||b[18]!==w||b[19]!==x||b[20]!==y?(J=function(){q==null?void 0:q.addPoint("render-audio-player",{bool:{has_next_attachment:w!=null,has_non_zero_duration:v>0,has_playable_url:Boolean(x),has_waveform:y!=null,is_disappearing_message:C},string:{audio_blob_duration_bucket:d("MWMediaRenderQplUtils").convertDurationToStringBucket(v)}})},K=[v,C,q,w,x,y],b[15]=v,b[16]=C,b[17]=q,b[18]=w,b[19]=x,b[20]=y,b[21]=J,b[22]=K):(J=b[21],K=b[22]);l(J,K);if(x==null||x.length===0){q==null?void 0:q.endFail("empty_preview_url");if(t!=null){b[23]!==e||b[24]!==t?(J=t(e),b[23]=e,b[24]=t,b[25]=J):J=b[25];return J}}K=c("MWPAudioPlayerKeyCommands.react");t=c("MWPAudioPlayerContainer.react");J="mw_audio_player";J=d("MWPAudioPlayerUtils").UseCase;u=(h||(h=c("stylex")))(d("MWPAudioPlayerSharedStyles").styles.common,u,s?d("MWPAudioPlayerSharedStyles").styles.commonOutgoing:d("MWPAudioPlayerSharedStyles").styles.commonIncoming,n&&d("MWPAudioPlayerSharedStyles").styles.commonReply,s&&n&&d("MWPAudioPlayerSharedStyles").styles.commonOutgoingReply);n=e.isAttachmentConsumed===!0;b[26]!==r||b[27]!==i||b[28]!==E||b[29]!==D||b[30]!==B||b[31]!==z||b[32]!==s?(e=k.jsx(c("MWPAudioPlaybackButton.react"),{disabled:r,hasEnded:i,isLoading:E,isPaused:D,isPlaying:B,onPress:z,outgoing:s,scrubberRef:G}),b[26]=r,b[27]=i,b[28]=E,b[29]=D,b[30]=B,b[31]=z,b[32]=s,b[33]=e):e=b[33];b[34]!==f||b[35]!==p||b[36]!==v||b[37]!==i||b[38]!==F||b[39]!==H||b[40]!==B||b[41]!==g||b[42]!==s||b[43]!==A||b[44]!==n||b[45]!==e||b[46]!==y?(r=k.jsx(d("MWPAudioPlayerHighlight.react").MWPAudioPlayerHighlightV2,{audioEl:f,currentTime:p,duration:v,hasEnded:i,hasScrubber:F,isListened:n,isPlaying:B,onUpdateScrubber:g,outgoing:s,progressHighlightRef:A,scrubberRef:G,waveformData:y,xstyle:H,children:e}),b[34]=f,b[35]=p,b[36]=v,b[37]=i,b[38]=F,b[39]=H,b[40]=B,b[41]=g,b[42]=s,b[43]=A,b[44]=n,b[45]=e,b[46]=y,b[47]=r):r=b[47];b[48]!==B||b[49]!==s||b[50]!==I?(E=k.jsx("div",{children:B?k.jsxs(k.Fragment,{children:[k.jsx(c("MWPAudioPlayerTimer.react"),{outgoing:s,time:I}),k.jsx(d("MWPAudioPlayerButtons.react").PlaybackRateButton,{outgoing:s})]}):k.jsx(c("MWPAudioPlayerTimer.react"),{outgoing:s,time:I})}),b[48]=B,b[49]=s,b[50]=I,b[51]=E):E=b[51];b[52]!==u||b[53]!==r||b[54]!==E?(D=k.jsxs("div",{className:u,children:[r,E]}),b[52]=u,b[53]=r,b[54]=E,b[55]=D):D=b[55];b[56]!==t||b[57]!==f||b[58]!==F||b[59]!==q||b[60]!==a||b[61]!==J.PLAYER||b[62]!==D?(z=k.jsx(t,{audioEl:f,hasScrubber:F,mediaRenderQpl:q,scrubberRef:G,style:a,testid:void 0,useCase:J.PLAYER,children:D}),b[56]=t,b[57]=f,b[58]=F,b[59]=q,b[60]=a,b[61]=J.PLAYER,b[62]=D,b[63]=z):z=b[63];b[64]!==K||b[65]!==f||b[66]!==z?(p=k.jsx(K,{audioEl:f,children:z}),b[64]=K,b[65]=f,b[66]=z,b[67]=p):p=b[67];return p}g["default"]=a}),98);
__d("useMAWMaybeTriggerODCutoverForSecureThread",["I64","Int64Hooks","LSMessagingThreadTypeUtil","MAWOnDemandCutoverTrigger","ReQL","ReQLSuspense","gkx","react-compiler-runtime","useMAWCanThreadBeCutoverOnDemandV2","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var b=d("react-compiler-runtime").c(10),e=a.threadKey,g=a.threadType,k=a.triggerSource,l=(i||(i=c("useReStore")))();b[0]!==l.tables._user_info?(a=function(){return d("ReQL").fromTableAscending(l.tables._user_info).map(j)},b[0]=l.tables._user_info,b[1]=a):a=b[1];var m;b[2]!==l?(m=[l],b[2]=l,b[3]=m):m=b[3];var n=d("ReQLSuspense").useFirst(a,m,f.id+":39"),o=(a=d("ReQLSuspense").useFirst(function(){return e!=null&&g!=null&&n!=null&&d("LSMessagingThreadTypeUtil").isArmadilloSecureOneToOne(g)?d("ReQL").fromTableAscending(l.tables.participants,["contactId"]).getKeyRange(e).filter(function(a){return!(h||(h=d("I64"))).equal(a.contactId,n)}):d("ReQL").empty()},[l,e,g,n],f.id+":44"))==null?void 0:a.contactId,p=c("useMAWCanThreadBeCutoverOnDemandV2")(o);b[4]!==p||b[5]!==l||b[6]!==o||b[7]!==k?(m=function(){o!=null&&p&&c("gkx")("7867")&&d("MAWOnDemandCutoverTrigger").triggerOnDemandCutover(l,o,k)},a=[p,l,o,k],b[4]=p,b[5]=l,b[6]=o,b[7]=k,b[8]=m,b[9]=a):(m=b[8],a=b[9]);d("Int64Hooks").useEffectInt64(m,a)}function j(a){return a.facebookUserId}g["default"]=a}),98);